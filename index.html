<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For My Snow (Maneef)</title>
    <style>
        /* --- 1. CORE SYSTEM (FONTS & RESET) --- */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Orbitron:wght@500&family=Poppins:wght@300;600&family=Cinzel:wght@600&family=VT323&display=swap');
        
        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        body, html { width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Poppins', sans-serif; }

        /* --- 2. TRANSITION LAYER (The Magic Curtain) --- */
        #transition-curtain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000; pointer-events: none;
            opacity: 1; transition: opacity 1.5s ease-in-out;
        }
        .fade-out { opacity: 0 !important; }

        /* --- 3. UI ELEMENTS (Music & Nav) --- */
        #music-player {
            position: fixed; bottom: 30px; right: 30px; z-index: 9000;
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255, 77, 109, 0.2); border: 1px solid #ff4d6d;
            display: flex; justify-content: center; align-items: center; cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 77, 109, 0.3); transition: 0.3s;
        }
        #music-player:active { transform: scale(0.9); }
        .vinyl-icon { font-size: 24px; animation: spin 3s linear infinite; animation-play-state: paused; }
        .playing .vinyl-icon { animation-play-state: running; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* --- 4. WORLD CONTAINER LOGIC --- */
        .world {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transform: scale(1.1);
            transition: opacity 1s ease, transform 1s ease;
            z-index: 1; overflow: hidden;
        }
        .active-world {
            opacity: 1; pointer-events: all; transform: scale(1); z-index: 10;
        }

        /* --- 5. NEXT BUTTON (The Key) --- */
        .next-btn {
            position: absolute; bottom: 40px; padding: 12px 30px;
            background: transparent; border: 2px solid rgba(255,255,255,0.5); color: white;
            border-radius: 30px; cursor: pointer; font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px; text-transform: uppercase; transition: 0.3s;
            opacity: 0; transform: translateY(20px); pointer-events: none;
        }
        .show-next { opacity: 1; transform: translateY(0); pointer-events: all; }
        .next-btn:hover { background: white; color: black; box-shadow: 0 0 15px white; }

        /* =========================================
           WORLD 1: COSMIC INTRO (SRK Vibe)
           ========================================= */
        #world-1 {
            background: radial-gradient(circle at center, #1a0b2e 0%, #000000 100%);
            color: white; text-align: center;
        }
        .srk-shadow {
            font-size: 150px; opacity: 0; filter: blur(5px);
            animation: srkEnter 3s ease-out forwards 0.5s;
        }
        @keyframes srkEnter {
            0% { transform: scale(0.8); opacity: 0; filter: blur(10px); }
            100% { transform: scale(1); opacity: 1; filter: blur(0); }
        }
        .title-main {
            font-family: 'Cinzel', serif; font-size: 3.5rem; margin-top: 20px;
            text-shadow: 0 0 20px rgba(255, 77, 109, 0.8);
            opacity: 0; animation: fadeUp 2s ease forwards 1.5s;
        }
        .subtitle {
            font-size: 1rem; color: #ffb6c1; letter-spacing: 3px; margin-top: 10px;
            opacity: 0; animation: fadeUp 2s ease forwards 2s;
        }
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }

        /* =========================================
           WORLD 2: KATIHAR (Sunset Parallax)
           ========================================= */
        #world-2 {
            background: linear-gradient(180deg, #ff9a9e 0%, #fecfef 50%, #a18cd1 100%);
            overflow: hidden;
        }
        .sun {
            position: absolute; top: 15%; right: 15%; width: 120px; height: 120px;
            background: #ffecd2; border-radius: 50%;
            box-shadow: 0 0 60px #ff9a9e; animation: pulseSun 4s infinite alternate;
        }
        @keyframes pulseSun { from { transform: scale(1); } to { transform: scale(1.1); } }
        
        .landscape {
            position: absolute; bottom: 0; width: 100%; height: 60%;
            display: flex; align-items: flex-end; justify-content: center;
        }
        .tree { font-size: 180px; position: absolute; bottom: 15%; left: 10%; opacity: 0.8; }
        .couple-walk {
            font-size: 80px; position: absolute; bottom: 15%; 
            animation: walkIn 4s linear forwards;
        }
        @keyframes walkIn { from { left: -20%; } to { left: 40%; } }
        .katihar-text {
            position: absolute; top: 20%; left: 10%; font-family: 'Dancing Script', cursive;
            font-size: 2.5rem; color: #fff; text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            opacity: 0; animation: fadeUp 2s ease forwards 3s;
        }

        /* =========================================
           WORLD 3: THE GLITCH (Raw Emotion)
           ========================================= */
        #world-3 {
            background: #000; color: #ff003c; font-family: 'VT323', monospace;
        }
        .glitch-container { position: relative; }
        .glitch-title {
            font-size: 5rem; text-transform: uppercase; position: relative;
            text-shadow: 2px 0 #fff, -2px 0 #0ff;
            animation: glitch-anim 0.3s infinite;
        }
        @keyframes glitch-anim {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        .console-log {
            font-size: 1.2rem; color: #00ff00; margin-top: 20px; text-align: left;
            width: 80%; max-width: 400px; border-left: 2px solid #00ff00; padding-left: 15px;
        }

        /* =========================================
           WORLD 4: PCM SCIENCE (Blueprint)
           ========================================= */
        #world-4 {
            background-color: #0d1117;
            background-image: radial-gradient(#232936 1px, transparent 1px);
            background-size: 30px 30px; color: #58a6ff;
        }
        .blueprint-card {
            border: 2px solid #58a6ff; padding: 20px; border-radius: 10px;
            background: rgba(13, 17, 23, 0.9); position: relative;
        }
        .blueprint-card::before {
            content: "PROJECT: SNOW"; position: absolute; top: -15px; left: 20px;
            background: #0d1117; padding: 0 10px; color: #58a6ff; font-weight: bold;
        }
        canvas#heart-math { border: 1px solid rgba(88, 166, 255, 0.3); margin-top: 20px; }

        /* =========================================
           WORLD 5: GAME (Mandatory)
           ========================================= */
        #world-5 {
            background: #200f21; border: 10px solid #3e204a;
            box-shadow: inset 0 0 50px #000;
        }
        .game-ui {
            width: 320px; height: 450px; border: 4px solid #fff; position: relative;
            background: #000; overflow: hidden; cursor: none;
        }
        #basket {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
            font-size: 40px; pointer-events: none;
        }
        .falling-heart { position: absolute; font-size: 24px; top: -30px; }
        .game-score {
            position: absolute; top: 10px; right: 10px; color: #fff; font-family: 'VT323'; font-size: 1.5rem;
        }
        .tutorial { color: #fff; margin-bottom: 10px; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* =========================================
           WORLD 6: LETTER (Interactive)
           ========================================= */
        #world-6 {
            background: #f3f3f3; color: #333;
        }
        .env-wrapper { perspective: 1000px; cursor: pointer; transition: transform 0.3s; }
        .env-wrapper:hover { transform: scale(1.05); }
        .envelope {
            width: 300px; height: 200px; background: #e0c097; position: relative;
            transform-style: preserve-3d; transition: 0.6s;
        }
        .flap {
            position: absolute; top: 0; left: 0; width: 0; height: 0;
            border-left: 150px solid transparent; border-right: 150px solid transparent;
            border-top: 100px solid #c5a075; transform-origin: top; transition: 0.5s; z-index: 5;
        }
        .letter-paper {
            position: absolute; top: 10px; left: 10px; width: 280px; height: 180px;
            background: #fff; padding: 20px; font-family: 'Dancing Script', cursive; font-size: 1.1rem;
            transition: 0.5s; z-index: 3; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center; text-align: center;
        }
        .open .flap { transform: rotateX(180deg); }
        .open .letter-paper { transform: translateY(-120px); height: 350px; z-index: 6; }

        /* =========================================
           WORLD 7: FINALE (The Question)
           ========================================= */
        #world-7 {
            background: radial-gradient(circle, #ffdde1 0%, #ee9ca7 100%);
        }
        .final-card {
            background: rgba(255, 255, 255, 0.8); padding: 40px; border-radius: 20px;
            text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px); width: 90%; max-width: 500px;
        }
        .final-title { font-family: 'Dancing Script'; font-size: 3rem; color: #ff4d6d; }
        .timer-display {
            font-family: 'Orbitron'; color: #555; margin: 20px 0; font-size: 1.2rem;
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
        }
        .t-box div { font-size: 0.8rem; color: #999; }
        .action-area { position: relative; height: 60px; margin-top: 30px; }
        .btn-yes {
            background: #ff4d6d; color: white; border: none; padding: 15px 40px;
            border-radius: 50px; font-size: 1.2rem; cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 77, 109, 0.4); transition: 0.3s;
        }
        .btn-yes:hover { transform: scale(1.1); }
        .btn-no {
            position: absolute; background: #ddd; color: #555; border: none;
            padding: 10px 20px; border-radius: 50px; cursor: default;
        }

        /* --- PARTICLES & DECOR --- */
        #particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
    </style>
</head>
<body>

    <audio id="bg-music" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/24/audio_3497e74360.mp3?filename=romantic-piano-11075.mp3" type="audio/mpeg">
    </audio>
    <div id="music-player" onclick="toggleMusic()">
        <div class="vinyl-icon">üéµ</div>
    </div>

    <div id="transition-curtain"></div>
    <canvas id="particles"></canvas>

    <section id="world-1" class="world active-world">
        <div class="srk-shadow">üï∫</div>
        <h1 class="title-main">Welcome to My Heart</h1>
        <p class="subtitle">A DIGITAL UNIVERSE FOR MINNIE</p>
        <button class="next-btn show-next" onclick="goToWorld(2)">Enter the Story</button>
    </section>

    <section id="world-2" class="world">
        <div class="sun"></div>
        <div class="katihar-text">"All roads lead to Katihar..."</div>
        <div class="landscape">
            <div class="tree">üå≥</div>
            <div class="couple-walk">üö∂‚Äç‚ôÇÔ∏èüö∂‚Äç‚ôÄÔ∏è</div>
        </div>
        <button class="next-btn" id="btn-2" onclick="goToWorld(3)">But then...</button>
    </section>

    <section id="world-3" class="world">
        <div class="glitch-container">
            <h1 class="glitch-title">SYSTEM FAILURE</h1>
        </div>
        <div class="console-log">
            <p>> ERROR: User 'Sajal' was lost.</p>
            <p>> DETECTED: Missing 'Snow'.</p>
            <p>> STATUS: REBUILDING...</p>
        </div>
        <button class="next-btn" id="btn-3" onclick="goToWorld(4)">Fix The Code</button>
    </section>

    <section id="world-4" class="world">
        <div class="blueprint-card">
            <h3>LOGIC REPAIRED.</h3>
            <p>Variable: Love = Infinity</p>
            <canvas id="heart-math" width="300" height="300"></canvas>
        </div>
        <p style="margin-top: 20px; opacity: 0.7;">Proving my heart beats in Sine Waves.</p>
        <button class="next-btn show-next" onclick="goToWorld(5)">Play The Game</button>
    </section>

    <section id="world-5" class="world">
        <p class="tutorial">MOVE MOUSE/TOUCH TO CATCH HEARTS! <br> (Need 5 to pass)</p>
        <div class="game-ui" id="game-area">
            <div class="game-score">SCORE: <span id="score">0</span>/5</div>
            <div id="basket">üß∫</div>
        </div>
        <button class="next-btn" id="btn-5" onclick="goToWorld(6)">Read Message</button>
    </section>

    <section id="world-6" class="world">
        <div class="env-wrapper" onclick="openEnvelope()">
            <div class="envelope">
                <div class="flap"></div>
                <div class="letter-paper">
                    <p id="type-text"></p>
                </div>
            </div>
        </div>
        <p style="margin-top: 30px; color: #888;">Tap to Open</p>
        <button class="next-btn" id="btn-6" onclick="goToWorld(7)">The Finale</button>
    </section>

    <section id="world-7" class="world">
        <div class="final-card">
            <h1 class="final-title">Maneef...</h1>
            <p>You are my bug fix, my happiness, my Snow.</p>
            
            <div class="timer-display">
                <div class="t-box"><span id="d">00</span><div>DAYS</div></div>
                <div class="t-box"><span id="h">00</span><div>HRS</div></div>
                <div class="t-box"><span id="m">00</span><div>MIN</div></div>
                <div class="t-box"><span id="s">00</span><div>SEC</div></div>
            </div>

            <div class="action-area">
                <button class="btn-yes" onclick="celebrate()">Will you be my Valentine?</button>
                <button class="btn-no" id="no-btn" onmouseover="runaway()">NO</button>
            </div>
        </div>
    </section>

    <script>
        // --- 1. CORE NAVIGATION ---
        function goToWorld(n) {
            // Remove active class from current
            document.querySelector('.active-world').classList.remove('active-world');
            
            // Add active class to next
            const next = document.getElementById(`world-${n}`);
            next.classList.add('active-world');

            // Specific triggers
            if(n === 2) setTimeout(() => document.getElementById('btn-2').classList.add('show-next'), 4000);
            if(n === 3) setTimeout(() => document.getElementById('btn-3').classList.add('show-next'), 3000);
            if(n === 4) startMathAnim();
            if(n === 5) startGame();
            if(n === 7) startTimer();
        }

        // --- 2. MUSIC PLAYER ---
        const audio = document.getElementById('bg-music');
        let isPlaying = false;
        
        function toggleMusic() {
            if(!isPlaying) {
                audio.play().catch(e => alert("Tap screen to enable audio!"));
                document.querySelector('.vinyl-icon').classList.add('playing'); // Fixed animation class
                isPlaying = true;
            } else {
                audio.pause();
                document.querySelector('.vinyl-icon').classList.remove('playing');
                isPlaying = false;
            }
        }

        // --- 3. PAGE LOAD FADE ---
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('transition-curtain').classList.add('fade-out');
            }, 500);
        }

        // --- 4. MATH HEART ANIMATION ---
        function startMathAnim() {
            const cvs = document.getElementById('heart-math');
            const ctx = cvs.getContext('2d');
            ctx.translate(150, 150); ctx.scale(1, -1);
            let t = 0;
            
            function draw() {
                ctx.fillStyle = "rgba(13, 17, 23, 0.1)";
                ctx.fillRect(-150, -150, 300, 300);
                
                ctx.beginPath();
                ctx.strokeStyle = "#58a6ff"; ctx.lineWidth = 2;
                
                // Cardioid Formula
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                
                ctx.arc(x*5, y*5, 2, 0, Math.PI*2);
                ctx.fill();
                ctx.stroke();

                t += 0.05;
                if(t < 100) requestAnimationFrame(draw);
            }
            draw();
        }

        // --- 5. GAME LOGIC (Glitch Free) ---
        let score = 0;
        function startGame() {
            const area = document.getElementById('game-area');
            const basket = document.getElementById('basket');
            
            // Mouse/Touch Follow
            area.addEventListener('mousemove', e => {
                let rect = area.getBoundingClientRect();
                let x = e.clientX - rect.left;
                if(x < 20) x = 20; if(x > 300) x = 300;
                basket.style.left = x + 'px';
            });

            // Spawner
            let spawner = setInterval(() => {
                if(score >= 5) {
                    clearInterval(spawner);
                    document.getElementById('btn-5').classList.add('show-next');
                    document.querySelector('.tutorial').innerText = "UNLOCKED! CLICK BUTTON BELOW";
                    return;
                }
                
                let heart = document.createElement('div');
                heart.innerText = '‚ù§Ô∏è';
                heart.className = 'falling-heart';
                heart.style.left = Math.random() * 280 + 'px';
                area.appendChild(heart);
                
                let pos = 0;
                let fall = setInterval(() => {
                    pos += 4;
                    heart.style.top = pos + 'px';
                    
                    // Collision
                    let bRect = basket.getBoundingClientRect();
                    let hRect = heart.getBoundingClientRect();
                    
                    if(hRect.bottom >= bRect.top && hRect.right >= bRect.left && hRect.left <= bRect.right) {
                        score++;
                        document.getElementById('score').innerText = score;
                        heart.remove();
                        clearInterval(fall);
                    }
                    
                    if(pos > 450) { heart.remove(); clearInterval(fall); }
                }, 20);
            }, 800);
        }

        // --- 6. ENVELOPE & TYPEWRITER ---
        const msg = "My Dearest Snow,\nI know I messed up before.\nBut you are the only code\nthat matters to me.\nI love you.";
        let typed = false;
        
        function openEnvelope() {
            const env = document.querySelector('.envelope');
            env.classList.add('open');
            
            if(!typed) {
                let i = 0;
                const p = document.getElementById('type-text');
                p.innerHTML = "";
                let timer = setInterval(() => {
                    if(i < msg.length) {
                        p.innerHTML += msg.charAt(i) === '\n' ? '<br>' : msg.charAt(i);
                        i++;
                    } else {
                        clearInterval(timer);
                        setTimeout(() => document.getElementById('btn-6').classList.add('show-next'), 1000);
                    }
                }, 100);
                typed = true;
            }
        }

        // --- 7. FINALE UTILS ---
        function runaway() {
            const btn = document.getElementById('no-btn');
            btn.style.left = Math.random() * 200 + 'px';
            btn.style.top = Math.random() * 50 + 'px';
        }

        function celebrate() {
            alert("I knew it! See you in Katihar! ‚ù§Ô∏è");
            // Confetti Blast
            for(let i=0; i<50; i++) {
                let c = document.createElement('div');
                c.style.position = 'fixed';
                c.style.left = Math.random() * 100 + 'vw';
                c.style.top = '-10px';
                c.innerText = 'üå∏';
                c.style.fontSize = Math.random()*20+10 + 'px';
                c.style.animation = `fall ${Math.random()*3+2}s linear forwards`;
                document.body.appendChild(c);
            }
        }
        
        // Add CSS for confetti
        const style = document.createElement('style');
        style.innerHTML = `@keyframes fall { to { transform: translateY(100vh) rotate(360deg); } }`;
        document.head.appendChild(style);

        // Timer
        function startTimer() {
            const start = new Date("November 28, 2025").getTime();
            setInterval(() => {
                const now = new Date().getTime();
                const diff = now - start;
                document.getElementById('d').innerText = Math.floor(diff / (1000*60*60*24));
                document.getElementById('h').innerText = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
                document.getElementById('m').innerText = Math.floor((diff % (1000*60*60)) / (1000*60));
                document.getElementById('s').innerText = Math.floor((diff % (1000*60)) / 1000);
            }, 1000);
        }
    </script>
</body>
</html>
